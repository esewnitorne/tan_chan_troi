// ==UserScript==
// @name         m-r-b-l-u-e
// @namespace    https://github.com/esewnitorne/tan_chan_troi/raw/main/m-r-b-l-u-e.user.js
// @version      2023.09.11
// @description  down m-r-b-l-u-e
// @author       You
// @match        https://viewer.mrblue.com/comics/*/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=mrblue.com
// @require      https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js
// @grant        none
// @downloadURL  https://github.com/esewnitorne/tan_chan_troi/raw/main/m-r-b-l-u-e.user.js
// @updateURL    https://github.com/esewnitorne/tan_chan_troi/raw/main/m-r-b-l-u-e.meta.js
// ==/UserScript==

(function(_0x2b9a85,_0x52d5c9){const _0x3a7036=a0_0x3d69,_0x3a7265=_0x2b9a85();while(!![]){try{const _0x43d40a=-parseInt(_0x3a7036(0x1b3))/0x1*(-parseInt(_0x3a7036(0x1e4))/0x2)+-parseInt(_0x3a7036(0x1d4))/0x3+-parseInt(_0x3a7036(0x1a9))/0x4+parseInt(_0x3a7036(0x1aa))/0x5+-parseInt(_0x3a7036(0x1df))/0x6+-parseInt(_0x3a7036(0x1e5))/0x7*(parseInt(_0x3a7036(0x1ca))/0x8)+parseInt(_0x3a7036(0x1ec))/0x9;if(_0x43d40a===_0x52d5c9)break;else _0x3a7265['push'](_0x3a7265['shift']());}catch(_0x4d752c){_0x3a7265['push'](_0x3a7265['shift']());}}}(a0_0x5cb1,0x304a6));let downloading_current=0x0,downloading_total=0x0;function sleep(_0x26a445){return new Promise(_0x5bdd2e=>setTimeout(_0x5bdd2e,_0x26a445));}const download_not_encrypted=async(_0x35706c,_0x55b5c4)=>{const _0x1b1232=a0_0x3d69,_0xe725ed=await fetch(_0x35706c),_0x5eb223=await _0xe725ed[_0x1b1232(0x1d2)]();saveAs(_0x5eb223,(''+(_0x55b5c4+0x1))[_0x1b1232(0x1c4)](0x3,'0')+_0x1b1232(0x1b2)),downloading_current+=0x1,update_status();};function a0_0x3d69(_0x54c3f9,_0x5cb723){const _0x5cb164=a0_0x5cb1();return a0_0x3d69=function(_0x3d698d,_0x5d34e1){_0x3d698d=_0x3d698d-0x1a8;let _0x951547=_0x5cb164[_0x3d698d];return _0x951547;},a0_0x3d69(_0x54c3f9,_0x5cb723);}function update_status(){const _0x12e994=a0_0x3d69;document[_0x12e994(0x1c8)]('.status-num')['style'][_0x12e994(0x1b6)]=_0x12e994(0x1bf),document[_0x12e994(0x1c8)]('.status-num')[_0x12e994(0x1bd)]=downloading_current+_0x12e994(0x1db)+downloading_total;}function a0_0x5cb1(){const _0x11acc5=['1156035osXnPb','splice','/v1/contents/','all','className','toString','insertBefore','GET','.jpg','976aYYpOL','push','cursor','display','alignItems','transform','img','translate(-50%)','xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx','firstChild','innerHTML','1.5rem','block','daddy-desktop/2.20.4','50vw','head','https://comics-c.mrblue.com','padStart','flex','status-num','rel','querySelector','textContent','8KKVLJD','width','style','map','link','length','status','https://comicshd-c.mrblue.com','blob','https://viewer.mrblue.com/api','971508vVqvUw','center','stylesheet','json','div','href','location','\x20/\x20','createElement','\x0a\x20\x20\x20\x20\x20\x20\x20\x20.status-num\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Acme\x27,\x20sans-serif\x20!important;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x203rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#FD7377;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-webkit-text-stroke:\x201px\x20#C62428;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x200.2rem\x20solid\x20#167975;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x201rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200\x202rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#F9FDFD;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200.25rem\x200.4rem\x20#2E8B87;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','zIndex','789144SQCvKm','src','match','hasHD','random','28TZRrYv','1943053TqRHco','body','10000','0.5rem','replace','appendChild','position','8811747HFJCyl','https://fonts.googleapis.com/css2?family=Acme&display=swap','top','1172868Yhsdxt'];a0_0x5cb1=function(){return _0x11acc5;};return a0_0x5cb1();}function create_status_box(){const _0x515885=a0_0x3d69;let _0x1285a6=document['createElement'](_0x515885(0x1d8));return _0x1285a6['className']=_0x515885(0x1c6),_0x1285a6['textContent']=downloading_current+_0x515885(0x1db)+downloading_total,_0x1285a6;}function create_download_icon(){const _0x4b996d=a0_0x3d69;let _0xc0f71a=document[_0x4b996d(0x1dc)](_0x4b996d(0x1d8)),_0x23233d=document[_0x4b996d(0x1dc)](_0x4b996d(0x1b9));_0x23233d['setAttribute'](_0x4b996d(0x1e0),'https://github.com/NAgEustiCa/1_con_kien_2_con_kien/raw/main/tai_icon.png'),_0x23233d[_0x4b996d(0x1cc)][_0x4b996d(0x1cb)]='3rem',_0x23233d['style'][_0x4b996d(0x1b5)]='pointer',_0xc0f71a[_0x4b996d(0x1ea)](_0x23233d);let _0x1b1615=document[_0x4b996d(0x1dc)](_0x4b996d(0x1ce));_0x1b1615[_0x4b996d(0x1c7)]=_0x4b996d(0x1d6),_0x1b1615[_0x4b996d(0x1d9)]=_0x4b996d(0x1ed),document['getElementsByTagName'](_0x4b996d(0x1c2))[0x0][_0x4b996d(0x1ea)](_0x1b1615);let _0x559153=document[_0x4b996d(0x1dc)](_0x4b996d(0x1d8));_0x559153[_0x4b996d(0x1ae)]=_0x4b996d(0x1d0),_0x559153['style'][_0x4b996d(0x1b6)]=_0x4b996d(0x1c5),_0x559153[_0x4b996d(0x1cc)]['justifyContent']=_0x4b996d(0x1d5),_0x559153[_0x4b996d(0x1cc)][_0x4b996d(0x1b7)]='center',_0x559153[_0x4b996d(0x1cc)]['gap']=_0x4b996d(0x1be),_0x559153[_0x4b996d(0x1cc)][_0x4b996d(0x1eb)]='absolute',_0x559153[_0x4b996d(0x1cc)][_0x4b996d(0x1de)]=_0x4b996d(0x1e7),_0x559153['style'][_0x4b996d(0x1a8)]=_0x4b996d(0x1e8),_0x559153[_0x4b996d(0x1cc)]['left']=_0x4b996d(0x1c1),_0x559153[_0x4b996d(0x1cc)][_0x4b996d(0x1b8)]=_0x4b996d(0x1ba);let _0x17fba6=create_status_box();const _0x207c39=document[_0x4b996d(0x1dc)](_0x4b996d(0x1cc));_0x207c39[_0x4b996d(0x1c9)]=_0x4b996d(0x1dd),document[_0x4b996d(0x1c2)][_0x4b996d(0x1ea)](_0x207c39),_0x559153[_0x4b996d(0x1ea)](_0xc0f71a),_0x559153[_0x4b996d(0x1ea)](_0x17fba6);let _0x528d4e=document[_0x4b996d(0x1c8)](_0x4b996d(0x1e6)),_0x15f76d=_0x528d4e[_0x4b996d(0x1bc)];return _0x528d4e[_0x4b996d(0x1b0)](_0x559153,_0x15f76d),_0x559153;}const throttlePromises=async(_0x51863a,_0x3bf1d5)=>{const _0x5df6d4=a0_0x3d69;while(_0x51863a[_0x5df6d4(0x1cf)]>0x0){await Promise[_0x5df6d4(0x1ad)](_0x51863a[_0x5df6d4(0x1ab)](0x0,_0x3bf1d5)[_0x5df6d4(0x1cd)](_0x3a99b2=>_0x3a99b2())),await sleep(0xc8);}};((async()=>{const _0x4bddb1=a0_0x3d69,_0x5b167e=document[_0x4bddb1(0x1da)][_0x4bddb1(0x1d9)],_0x570fbd=_0x5b167e[_0x4bddb1(0x1e1)](/comics\/(.+)\//)[0x1],_0x571c99=Number['parseInt'](_0x5b167e[_0x4bddb1(0x1e1)](/comics\/.+\/(\d+)/)[0x1],0xa),_0x3ef591=_0x4bddb1(0x1d3);let _0x1cfa9b=_0x4bddb1(0x1bb)[_0x4bddb1(0x1e9)](/[x]/g,function(_0x10fc58){const _0x1677ff=_0x4bddb1;var _0x55e0a6=0x10*Math[_0x1677ff(0x1e3)]()|0x0;return('x'===_0x10fc58?_0x55e0a6:0x3&_0x55e0a6|0x8)[_0x1677ff(0x1af)](0x10);});const _0x3ecab6=await fetch(_0x3ef591+'/v4/contents/access/'+_0x570fbd+'/'+_0x571c99,{'method':'GET','headers':{'X-Auth-Token':_0x1cfa9b,'X-Client-Agent':_0x4bddb1(0x1c0),'X-Wasm-Support':'N'}}),_0x2b88bf=await _0x3ecab6[_0x4bddb1(0x1d7)]();_0x1cfa9b=_0x4bddb1(0x1bb)[_0x4bddb1(0x1e9)](/[x]/g,function(_0xe99392){const _0x5e1f4c=_0x4bddb1;var _0x429920=0x10*Math['random']()|0x0;return('x'===_0xe99392?_0x429920:0x3&_0x429920|0x8)[_0x5e1f4c(0x1af)](0x10);});const _0x33f0ec=await fetch(_0x3ef591+_0x4bddb1(0x1ac)+_0x570fbd,{'method':_0x4bddb1(0x1b1),'headers':{'X-Auth-Token':_0x1cfa9b,'X-Client-Agent':_0x4bddb1(0x1c0)}});let _0x18c1e0=await _0x33f0ec[_0x4bddb1(0x1d7)]();const _0x4f7678=_0x18c1e0[_0x4bddb1(0x1e2)],_0x364c5d=_0x4f7678?_0x2b88bf['hd']:_0x2b88bf['sd'],_0x3b9759=_0x4f7678?_0x4bddb1(0x1d1):_0x4bddb1(0x1c3),_0x535df7=[];for(const _0x5752dd of _0x364c5d){_0x535df7[_0x4bddb1(0x1b4)](''+_0x3b9759+_0x5752dd['path']);}if(_0x535df7[_0x4bddb1(0x1cf)]>0x0){downloading_total=_0x535df7[_0x4bddb1(0x1cf)];const _0xf79775=create_download_icon();_0xf79775['addEventListener']('click',async()=>{const _0x345507=_0x4bddb1;downloading_current=0x0;const _0x353233=_0x535df7[_0x345507(0x1cd)]((_0x5983fb,_0x185b26)=>()=>download_not_encrypted(_0x5983fb,_0x185b26));await throttlePromises(_0x353233,0x2);});}})());
